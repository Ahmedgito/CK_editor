/*
 *             Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import{Command as _0x3b8771,Plugin as _0x2affe4}from'@ckeditor/ckeditor5-core/dist/index.js';import{ButtonView as _0x42d8e7,MenuBarMenuListItemButtonView as _0x2bdb0b,SpinnerView as _0x2f719b,Notification as _0x40ca17}from'@ckeditor/ckeditor5-ui/dist/index.js';import{collectStylesheets as _0xc7e883}from'@ckeditor/ckeditor5-utils/dist/index.js';import{IconExportPdf as _0x3a01b7}from'@ckeditor/ckeditor5-icons/dist/index.js';function n(_0xd76f9a,_0x32d8ac){const t=_0xd76f9a['t'];switch(_0x32d8ac){case'Export\x20to\x20PDF':return t('Export\x20to\x20PDF');case'An\x20error\x20occurred\x20while\x20generating\x20the\x20PDF.':return t('An\x20error\x20occurred\x20while\x20generating\x20the\x20PDF.');case'PDF\x20export\x20started':return t('PDF\x20export\x20started');case'PDF\x20export\x20failed':return t('PDF\x20export\x20failed');case'PDF\x20export\x20successful':return t('PDF\x20export\x20successful');case'Exporting\x20PDF\x20document':return t('Exporting\x20PDF\x20document');default:return _0x32d8ac;}}class e extends _0x3b8771{constructor(_0x25844c){super(_0x25844c),this['set']('isBusy',!0x1),this['affectsData']=!0x1;}['refresh'](){this['isEnabled']=!this['isBusy'],this['value']=this['isBusy']?'pending':void 0x0;}['execute'](_0x347804={}){const _0x4a8690=this['editor'],_0x346677=_0x347804['converterUrl']||'https://pdf-converter.cke-cs.com/v1/convert/',_0x44f397=_0x347804['dataCallback']||(_0xc133d9=>_0xc133d9['data']['get']()),_0x56c194=_0x4a8690['plugins']['get']('ExportPdf'),_0x37d585=_0x347804['token']||_0x56c194['_token'];return this['isBusy']=!0x0,this['refresh'](),_0xc7e883(_0x347804['stylesheets']||['EDITOR_STYLES'])['then'](async _0x18962d=>{if(_0x4a8690['ui']['ariaLiveAnnouncer']['announce'](n(_0x4a8690['locale'],'PDF\x20export\x20started')),_0x4a8690['plugins']['has']('MergeFields')){_0x347804['converterOptions']||(_0x347804['converterOptions']={});const _0x5002e1=_0x4a8690['plugins']['get']('MergeFieldsEditing'),_0x351b36=_0x5002e1['previewMode'],{prefix:_0x403768,suffix:_0x2e2a97}=_0x4a8690['config']['get']('mergeFields'),_0x58d387='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP88B8AAuUB8e2ujYwAAAAASUVORK5CYII=',_0x385713={'prefix':_0x403768,'suffix':_0x2e2a97,'data':{}};if('$labels'===_0x351b36){for(const _0x1aa777 of _0x5002e1['getMergeFieldsIds']())'image'===_0x5002e1['getMergeFieldType'](_0x1aa777)?_0x385713['data'][_0x1aa777]=_0x58d387:_0x385713['data'][_0x1aa777]=_0x5002e1['wrapInAffixes'](_0x5002e1['getLabel'](_0x1aa777)||_0x1aa777);}else{const _0xd80ed2='$defaultValues'===_0x351b36?_0x5002e1['getDefaultValues']():_0x5002e1['getDataSetValues'](_0x351b36,!0x0);for(const _0x1bf072 of Object['entries'](_0xd80ed2)){const [_0x5a0893,_0x2bbbd9]=_0x1bf072;'image'===_0x5002e1['getMergeFieldType'](_0x5a0893)?_0x385713['data'][_0x5a0893]=null!==_0x2bbbd9?_0x2bbbd9:_0x58d387:_0x385713['data'][_0x5a0893]=null!==_0x2bbbd9?_0x2bbbd9:_0x5002e1['getLabel'](_0x5a0893)||_0x5a0893;}}_0x347804['converterOptions']['merge_fields']=_0x385713;}const _0x47df07=function(_0x401146){const _0x3f4ffc=(_0x358fe0=_0x401146?.['format']||'A4',{'letter':['21.6cm','27.9cm'],'legal':['21.6cm','35.6cm'],'tabloid':['27.9cm','43.2cm'],'ledger':['43.2cm','27.9cm'],'a0':['84.1cm','118.9cm'],'a1':['59.4cm','84.1cm'],'a2':['42.0cm','59.4cm'],'a3':['29.7cm','42.0cm'],'a4':['21.0cm','29.7cm'],'a5':['14.8cm','21.0cm'],'a6':['10.5cm','14.8cm']}[_0x358fe0['toLowerCase']()][0x0]),_0xf968a0=_0x401146?.['margin_left'],_0x2efbaa=_0x401146?.['margin_right'];var _0x358fe0;return'width:calc('+[_0x3f4ffc,..._0xf968a0?[_0xf968a0]:[],..._0x2efbaa?[_0x2efbaa]:[]]['join']('\x20-\x20')+');';}(_0x347804['converterOptions']),_0x44702f={'html':('\x0a\x09\x09\x09\x09\x09<!DOCTYPE\x20html>\x0a\x09\x09\x09\x09\x09<html>\x0a\x09\x09\x09\x09\x09\x09<head>\x0a\x09\x09\x09\x09\x09\x09\x09<title>CKEditor\x205\x20PDF\x20document</title>\x0a\x09\x09\x09\x09\x09\x09\x09<meta\x20charset=\x22utf-8\x22>\x0a\x09\x09\x09\x09\x09\x09</head>\x0a\x09\x09\x09\x09\x09\x09<body>\x0a\x09\x09\x09\x09\x09\x09\x09<div\x20class=\x22ck-content\x22\x20dir=\x22'+_0x4a8690['locale']['contentLanguageDirection']+'\x22\x20style=\x22'+_0x47df07+'\x22>\x0a\x09\x09\x09\x09\x09\x09\x09\x09'+await _0x44f397(_0x4a8690)+'\x0a\x09\x09\x09\x09\x09\x09\x09</div>\x0a\x09\x09\x09\x09\x09\x09</body>\x0a\x09\x09\x09\x09\x09</html>\x0a\x09\x09\x09\x09')['trim'](),'css':_0x18962d,'options':_0x347804['converterOptions']},_0x4f2234={'method':'POST','headers':{'Content-Type':'application/json','Accept':'application/pdf',..._0x37d585?{'Authorization':_0x37d585['value']}:null,'x-cs-app-id':_0x347804['appID']||'cke5'},'body':JSON['stringify'](_0x44702f)};return window['fetch'](_0x346677,_0x4f2234)['then'](_0x1d8688=>{if(0xc8!==_0x1d8688['status'])throw _0x1d8688;return _0x1d8688['blob']();})['then'](_0x32b991=>{_0x4a8690['ui']['ariaLiveAnnouncer']['announce'](n(_0x4a8690['locale'],'PDF\x20export\x20successful'));const _0x507738='function'==typeof _0x347804['fileName']?_0x347804['fileName']():_0x347804['fileName'];this['_downloadFile'](_0x32b991,_0x507738||'document.pdf');});})['catch'](_0x3890ed=>{const _0x8dd794=_0x4a8690['plugins']['get']('Notification');throw _0x4a8690['ui']['ariaLiveAnnouncer']['announce'](n(_0x4a8690['locale'],'PDF\x20export\x20failed'),{'politeness':'assertive'}),_0x8dd794['showWarning'](n(_0x4a8690['locale'],'An\x20error\x20occurred\x20while\x20generating\x20the\x20PDF.')),_0x3890ed;})['finally'](()=>{this['isBusy']=!0x1,this['refresh']();});}['_downloadFile'](_0x452fea,_0x1484e0){const _0xa42b3d=document['createElement']('a');_0xa42b3d['href']=window['URL']['createObjectURL'](_0x452fea),_0xa42b3d['download']=_0x1484e0,_0xa42b3d['click'](),_0xa42b3d['remove']();}}class o extends _0x2affe4{static get['pluginName'](){return'ExportPdfUI';}static get['isOfficialPlugin'](){return!0x0;}static get['isPremiumPlugin'](){return!0x0;}['init'](){const _0x244b40=this['editor'];_0x244b40['ui']['componentFactory']['add']('exportPdf',()=>{const _0x29139e=this['_createButton'](_0x42d8e7),_0x20b392=_0x244b40['commands']['get']('exportPdf');return _0x29139e['set']({'tooltip':!0x0}),_0x29139e['bind']('isOn')['to'](_0x20b392,'isBusy'),_0x29139e;}),_0x244b40['ui']['componentFactory']['add']('menuBar:exportPdf',()=>this['_createButton'](_0x2bdb0b));}['_createButton'](_0x2eea4a){const _0x23e7f9=this['editor'],_0x2cd367=_0x23e7f9['config']['get']('exportPdf')||{},_0x2a9a58=_0x23e7f9['commands']['get']('exportPdf'),_0x3df365=new _0x2eea4a(_0x23e7f9['locale']),_0x3e8df7=new _0x2f719b();return _0x3df365['children']['add'](_0x3e8df7),_0x3e8df7['bind']('isVisible')['to'](_0x2a9a58,'isBusy'),_0x3df365['iconView']['bind']('isVisible')['to'](_0x2a9a58,'isBusy',_0x2a730f=>!_0x2a730f),_0x3df365['set']({'icon':_0x3a01b7}),_0x3df365['bind']('isEnabled')['to'](_0x2a9a58,'isEnabled'),_0x3df365['bind']('label')['to'](_0x2a9a58,'isBusy',_0x26611b=>n(_0x23e7f9['locale'],_0x26611b?'Exporting\x20PDF\x20document':'Export\x20to\x20PDF')),this['listenTo'](_0x3df365,'execute',()=>{_0x23e7f9['execute']('exportPdf',_0x2cd367),_0x23e7f9['editing']['view']['focus']();}),_0x3df365;}}class a extends _0x2affe4{['_token'];static get['pluginName'](){return'ExportPdf';}static get['isOfficialPlugin'](){return!0x0;}static get['isPremiumPlugin'](){return!0x0;}static get['requires'](){return['CloudServices',_0x40ca17,o];}['init'](){const _0x4613bb=this['editor'],_0x272d41=_0x4613bb['config']['get']('exportPdf')||{};_0x4613bb['commands']['add']('exportPdf',new e(_0x4613bb));const _0x26e2be=_0x4613bb['plugins']['get']('CloudServices');!0x1===_0x272d41['tokenUrl']?this['_token']=null:_0x272d41['tokenUrl']?_0x26e2be['registerTokenUrl'](_0x272d41['tokenUrl'])['then'](_0x43422a=>{this['_token']=_0x43422a;}):this['_token']=_0x26e2be['token'];}}export{a as ExportPdf,e as ExportPdfCommand};