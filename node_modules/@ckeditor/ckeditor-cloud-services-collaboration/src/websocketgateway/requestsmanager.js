/*
 *             Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import _0x351023 from'../ckeditorcloudserviceserror.js';class WebSocketRequest{['_context'];['_deferredPromise']=(function(){let resolve,reject;const promise=new Promise((promiseResolve,promiseReject)=>{resolve=promiseResolve,reject=promiseReject;});return{'resolve':resolve,'reject':reject,'promise':promise};}());['timeout'];constructor(_0x9e3b85,_0x596681){this['_context']=_0x9e3b85,this['timeout']=setTimeout(()=>this['error'](new _0x351023('Request\x20timeout.',this['_context'])),_0x596681);}get['promise'](){return this['_deferredPromise']['promise'];}['response'](_0x176b7b){this['_deferredPromise']['resolve'](_0x176b7b);}['error'](_0x46033b){this['_deferredPromise']['reject'](_0x46033b);}}export default class WebSocketGatewayRequestsManager{['_context'];['_requests']=new Set();constructor(_0x4d715d){this['_context']=_0x4d715d;}async['send'](_0x51e2cb,_0x3482cd=0xafc8){const _0x4a6936=this['_createRequest'](_0x3482cd);try{return _0x51e2cb(_0x4a6936),await _0x4a6936['promise'];}finally{this['_finishRequest'](_0x4a6936);}}['errorAll'](_0x3ae7f7){for(const _0x3fcc0b of this['_requests'])_0x3fcc0b['error'](_0x3ae7f7);}['waitForAllRequests'](_0x538e31=0xafc8){return this['_waitForRequests'](_0x538e31);}['_createRequest'](_0x346cc5){const _0x307115=new WebSocketRequest(this['_context'],_0x346cc5);return this['_requests']['add'](_0x307115),_0x307115;}['_finishRequest'](_0xb24861){this['_requests']['delete'](_0xb24861),clearTimeout(_0xb24861['timeout']);}async['_waitForRequests'](_0x19e12e=0x1388,_0xd2af7e=0x0){return!this['_requests']['size']||_0xd2af7e>=_0x19e12e/0x1f4?Promise['resolve']():(await new Promise(_0x45bc7b=>{setTimeout(_0x45bc7b,0x1f4);}),this['_waitForRequests'](_0x19e12e,_0xd2af7e++));}}