/*
 *             Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x3d8b17=_0x7e14;(function(_0x9f2140,_0x2a6829){const _0x40baaa=_0x7e14,_0x2fd8f1=_0x9f2140();while(!![]){try{const _0x141d9e=parseInt(_0x40baaa(0x18c))/0x1+parseInt(_0x40baaa(0x1b9))/0x2+-parseInt(_0x40baaa(0x1b2))/0x3*(parseInt(_0x40baaa(0x17d))/0x4)+-parseInt(_0x40baaa(0x19a))/0x5+-parseInt(_0x40baaa(0x189))/0x6*(parseInt(_0x40baaa(0x161))/0x7)+-parseInt(_0x40baaa(0x177))/0x8+parseInt(_0x40baaa(0x1aa))/0x9*(parseInt(_0x40baaa(0x15e))/0xa);if(_0x141d9e===_0x2a6829)break;else _0x2fd8f1['push'](_0x2fd8f1['shift']());}catch(_0x3b4eb3){_0x2fd8f1['push'](_0x2fd8f1['shift']());}}}(_0x50b5,0xbf467));function _0x50b5(){const _0x4de6f8=['updateCurrentDocument','isCurrentDocumentInContext','getConversation','modification-delta','destroy','3763730zDzJkO','sessionId','ai-chat-conversation-already-started','7ApVdRh','reset','startConversation','error','getAll','getInteraction','getDocumentContext','hasOwn','contextItems','chatCapabilities','model','_extractContextItems','attributes','isAvailable','lastInteraction','selectedModel','interactions','getCapabilitiesConfig','ai-chat-conversation-init-from-id-failed','ai-chat-handle-user-conversation-not-initialized','_processMessagesToInteractions','addFilesToContext','12489240xfEKkC','fire','group','indexOf','conversationInitialized','addUrlToContext','3988888wsyySR','conversationStarted','addSelectionToContext','getAvailableModels','ai-chat-conversation-set-model-null','createReply','removeInteraction','ai-chat-conversation-set-model-not-available','addResourceToContext','options','reasoning','text','5786448ETQuLt','ai-chat-conversation-start-failed','modelSelected','472397aUwLXN','stop','content','webSearch','getEditor','ai-chat-conversation-init-failed','delegate','getPendingContextItems','conversationId','message','appendContent','addToConversationContext','find','prompt','5632320XlGEPD','toggleWebSearch','isStarted','currentInteraction','loadSourceResources','ai-chat-handle-user-interaction-already-in-progress','toLowerCase','interactionCreated','currentReply','removeSelectionFromContext','createInteraction','init','quickActionData','capabilities','user','toggleReasoning','117hqVSGO','push','role','title','connector','set','isSelectionInContext','type','3kfqjYP','length','chatContext','load','isCurrentDocumentInConversation','updateCurrentDocumentInContext','text-delta','134932mXxBug','getCurrentDocumentContext','setModel','stack','chatModels','assistant','getModel','fetchConversationMessages','removeFromContext','selectedModelId','splice','ai-chat-conversation-start-no-model-selected','handleUserInteraction','getMessages','setConversationTitle','start','populateFromMessage','fetchConversation','addCurrentDocumentToContext'];_0x50b5=function(){return _0x4de6f8;};return _0x50b5();}import{CKEditorError as _0x5cd399,EmitterMixin as _0x4ccff6,logWarning as _0x4c944b}from'ckeditor5/src/utils.js';import{AI_MODEL_EVENT_NAMES as _0x4b5fbe}from'../../aicore/model/aiinteraction.js';import{AIChatContext as _0x31de19,AI_CONTEXT_MODEL_EVENT_NAMES as _0x8b9e8b}from'./aichatcontext.js';function _0x7e14(_0x19fbe8,_0x7e7b06){const _0x50b520=_0x50b5();return _0x7e14=function(_0x7e14e7,_0x4ed6ee){_0x7e14e7=_0x7e14e7-0x147;let _0x39d9fd=_0x50b520[_0x7e14e7];return _0x39d9fd;},_0x7e14(_0x19fbe8,_0x7e7b06);}import{AICapabilities as _0x1f24d1,CAPABILITIES_MODEL_EVENT_NAMES as _0x5b0eb5}from'../../aicore/model/aicapabilities.js';import{AIChatInteraction as _0x111896}from'./aichatinteraction.js';export class AIChatConversation extends _0x4ccff6(){['id'];[_0x3d8b17(0x19c)]=!0x1;[_0x3d8b17(0x171)]=[];[_0x3d8b17(0x19d)];[_0x3d8b17(0x170)];[_0x3d8b17(0x1ae)];[_0x3d8b17(0x186)];constructor(_0x530b0f){const _0x4ac02a=_0x3d8b17;super(),this[_0x4ac02a(0x186)]=_0x530b0f,this[_0x4ac02a(0x1ae)]=_0x530b0f[_0x4ac02a(0x1ae)],this[_0x4ac02a(0x14a)]=_0x530b0f[_0x4ac02a(0x14a)],this['id']=_0x530b0f[_0x4ac02a(0x194)];}async[_0x3d8b17(0x1a5)](_0x16b680){const _0x1b6bea=_0x3d8b17;try{this[_0x1b6bea(0x1b4)]=new _0x31de19({'connector':this[_0x1b6bea(0x1ae)],'config':_0x16b680,'ownerId':this['id']}),this[_0x1b6bea(0x1b4)][_0x1b6bea(0x192)](..._0x8b9e8b)['to'](this),this[_0x1b6bea(0x1b4)][_0x1b6bea(0x1a5)](),this[_0x1b6bea(0x16a)]=new _0x1f24d1(),this[_0x1b6bea(0x16a)][_0x1b6bea(0x192)](..._0x5b0eb5)['to'](this),this[_0x1b6bea(0x16a)][_0x1b6bea(0x1a5)]();const _0x2c2c5b=await this[_0x1b6bea(0x14a)][_0x1b6bea(0x180)]();this[_0x1b6bea(0x178)](_0x1b6bea(0x17b),{'availableModels':_0x2c2c5b});const _0x25fc41=await this[_0x1b6bea(0x14a)][_0x1b6bea(0x14c)](this[_0x1b6bea(0x186)][_0x1b6bea(0x14f)]);_0x25fc41&&await this[_0x1b6bea(0x148)](_0x25fc41);}catch(_0x443ec2){const _0x4e0f8c=new _0x5cd399(_0x1b6bea(0x191),null,{'message':_0x443ec2[_0x1b6bea(0x195)]});_0x4e0f8c[_0x1b6bea(0x149)]=_0x443ec2[_0x1b6bea(0x149)],this[_0x1b6bea(0x178)](_0x1b6bea(0x164),{'error':_0x4e0f8c});}}async[_0x3d8b17(0x155)](){const _0x5865d5=_0x3d8b17;if(this[_0x5865d5(0x19c)])throw new _0x5cd399(_0x5865d5(0x160),null,{'conversation':this});if(!this[_0x5865d5(0x170)])throw new _0x5cd399(_0x5865d5(0x151),null,{'conversation':this});try{const {id:_0x3fbd63}=await this[_0x5865d5(0x1ae)][_0x5865d5(0x163)](this['id'],this[_0x5865d5(0x186)][_0x5865d5(0x179)])[_0x5865d5(0x15b)]();this['id']=_0x3fbd63,this[_0x5865d5(0x19c)]=!0x0,this[_0x5865d5(0x178)](_0x5865d5(0x17e),{'conversationId':this['id'],'selectedModel':this[_0x5865d5(0x170)]});}catch(_0x22f4a1){const _0x3476d6=new _0x5cd399(_0x5865d5(0x18a),null,{'message':_0x22f4a1[_0x5865d5(0x195)]});_0x3476d6[_0x5865d5(0x149)]=_0x22f4a1[_0x5865d5(0x149)],this[_0x5865d5(0x178)](_0x5865d5(0x164),{'error':_0x3476d6});}}async[_0x3d8b17(0x1b5)](_0x24df5c,_0x2e77e9){const _0x345c31=_0x3d8b17;try{const _0x3c8dfc=await this[_0x345c31(0x1ae)][_0x345c31(0x157)](_0x24df5c)[_0x345c31(0x15b)](),_0x3bfa42=await this[_0x345c31(0x1ae)][_0x345c31(0x14d)](_0x24df5c)[_0x345c31(0x153)](),_0x45ab4a=_0x3bfa42[0x0][_0x345c31(0x16b)];this[_0x345c31(0x19c)]=!0x0,this['id']=_0x3c8dfc['id'],_0x345c31(0x1ad)in _0x3c8dfc?this[_0x345c31(0x178)](_0x345c31(0x154),_0x3c8dfc[_0x345c31(0x1ad)],!0x0):this[_0x345c31(0x178)](_0x345c31(0x154),'',!0x0);const _0x4d7892=(await this[_0x345c31(0x14a)][_0x345c31(0x165)]())[_0x345c31(0x198)](_0x39ca9a=>_0x39ca9a['id'][_0x345c31(0x1a0)]()===_0x45ab4a[_0x345c31(0x1a0)]());return this[_0x345c31(0x170)]=_0x4d7892,this[_0x345c31(0x178)](_0x345c31(0x18b),{'selectedModel':_0x4d7892,'isDisabled':!0x0}),await this[_0x345c31(0x175)](_0x3bfa42,_0x2e77e9,_0x45ab4a),this[_0x345c31(0x19d)]=void 0x0,this;}catch(_0x4a4d42){const _0x133d11=new _0x5cd399(_0x345c31(0x173),null,{'message':_0x4a4d42[_0x345c31(0x195)],'conversationId':_0x24df5c});throw _0x133d11[_0x345c31(0x149)]=_0x4a4d42[_0x345c31(0x149)],this[_0x345c31(0x178)](_0x345c31(0x164),{'error':_0x133d11}),_0x133d11;}}async[_0x3d8b17(0x175)](_0x5c76b8,_0x4929ea,_0x267c2c){const _0x5d4ffb=_0x3d8b17;let _0x202122;for(const _0x39d162 of _0x5c76b8)if(_0x5d4ffb(0x1a8)===_0x39d162[_0x5d4ffb(0x1ac)]){const _0x4f1e05=await this[_0x5d4ffb(0x16c)](_0x39d162),_0x38fbdd={'isReasoningEnabled':Object[_0x5d4ffb(0x168)](_0x39d162[_0x5d4ffb(0x1a7)],_0x5d4ffb(0x187)),'isWebSearchEnabled':Object[_0x5d4ffb(0x168)](_0x39d162[_0x5d4ffb(0x1a7)],_0x5d4ffb(0x18f))};_0x202122=this[_0x5d4ffb(0x1a4)]({'userMessage':_0x39d162[_0x5d4ffb(0x199)],'contextItems':_0x4f1e05,'capabilities':_0x38fbdd,'modelId':_0x267c2c,'quickActionData':_0x39d162[_0x5d4ffb(0x16d)]?.[_0x5d4ffb(0x1a6)]}),this[_0x5d4ffb(0x19d)]=_0x202122,this[_0x5d4ffb(0x1b4)][_0x5d4ffb(0x197)](this[_0x5d4ffb(0x19d)][_0x5d4ffb(0x169)]);}else{if(_0x5d4ffb(0x14b)===_0x39d162[_0x5d4ffb(0x1ac)]&&_0x202122)for(const _0x21e6cc of _0x39d162[_0x5d4ffb(0x18e)]){const _0x468299=_0x5d4ffb(0x188)===_0x21e6cc[_0x5d4ffb(0x1b1)]?_0x5d4ffb(0x1b8):_0x5d4ffb(0x15c),_0x274bfb=_0x202122[_0x5d4ffb(0x167)]()?.[_0x5d4ffb(0x15f)]!==_0x4929ea;_0x202122[_0x5d4ffb(0x1a2)]=_0x202122[_0x5d4ffb(0x182)]({'type':_0x468299,'isDone':!0x0,'interactionId':_0x202122['id'],'areActionsDisabled':_0x274bfb}),_0x202122[_0x5d4ffb(0x1a2)][_0x5d4ffb(0x196)](_0x21e6cc[_0x5d4ffb(0x18e)]);}}}async[_0x3d8b17(0x16c)](_0x2a36be){const _0x5949fb=_0x3d8b17,_0x2248ab=new Map();if(!_0x2a36be[_0x5949fb(0x18e)])return _0x2248ab;for(const _0x13bc13 of _0x2a36be[_0x5949fb(0x18e)]){const _0x123321=await this[_0x5949fb(0x1b4)][_0x5949fb(0x156)](_0x13bc13);_0x123321&&_0x2248ab[_0x5949fb(0x1af)](_0x123321['id'],_0x123321);}return _0x2248ab;}async[_0x3d8b17(0x152)]({userMessage:_0x18d782,quickActionData:_0x39c718}){const _0x5024b4=_0x3d8b17;if(!this[_0x5024b4(0x19c)])throw new _0x5cd399(_0x5024b4(0x174),null,{'conversation':this});if(this[_0x5024b4(0x19d)])throw new _0x5cd399(_0x5024b4(0x19f),null,{'conversation':this});try{const _0x1b0a41=this[_0x5024b4(0x1b4)][_0x5024b4(0x193)](),_0x473d15=this[_0x5024b4(0x16a)][_0x5024b4(0x172)](),_0x48d51c=this[_0x5024b4(0x170)]['id'];this[_0x5024b4(0x19d)]=this[_0x5024b4(0x1a4)]({'userMessage':_0x18d782,'contextItems':_0x1b0a41,'capabilities':_0x473d15,'modelId':_0x48d51c,'quickActionData':_0x39c718}),await this[_0x5024b4(0x19d)][_0x5024b4(0x155)](),this[_0x5024b4(0x1b4)][_0x5024b4(0x197)](this[_0x5024b4(0x19d)][_0x5024b4(0x169)]);}catch(_0xf05fc5){this[_0x5024b4(0x178)](_0x5024b4(0x164),{'interactionId':this[_0x5024b4(0x19d)]?this[_0x5024b4(0x19d)]['id']:void 0x0,'error':_0xf05fc5});}finally{this[_0x5024b4(0x19d)]?.[_0x5024b4(0x18d)](),this[_0x5024b4(0x19d)]=void 0x0;}}[_0x3d8b17(0x1a4)]({userMessage:_0x782412,contextItems:_0x586aed,capabilities:_0x531c49,modelId:_0x523ddc,quickActionData:_0x475e31}){const _0x52011b=_0x3d8b17,_0x303b67=new _0x111896({'userMessage':_0x782412,'contextItems':_0x586aed,'capabilities':_0x531c49,'conversationId':this['id'],'connector':this[_0x52011b(0x1ae)],'editor':this[_0x52011b(0x186)][_0x52011b(0x190)]&&this[_0x52011b(0x186)][_0x52011b(0x190)](),'model':_0x523ddc,'quickActionData':_0x475e31});return _0x303b67[_0x52011b(0x192)](..._0x4b5fbe)['to'](this),this[_0x52011b(0x171)][_0x52011b(0x1ab)](_0x303b67),this[_0x52011b(0x178)](_0x52011b(0x1a1),_0x303b67),_0x303b67;}[_0x3d8b17(0x166)](_0x527be4){const _0x42d38a=_0x3d8b17;return this[_0x42d38a(0x171)][_0x42d38a(0x198)](_0x56a59b=>_0x56a59b['id']===_0x527be4);}[_0x3d8b17(0x183)](_0x5a42f2){const _0x5e79f8=_0x3d8b17,_0x55fc1a=this[_0x5e79f8(0x166)](_0x5a42f2);_0x55fc1a&&(_0x55fc1a[_0x5e79f8(0x15d)](),this[_0x5e79f8(0x171)][_0x5e79f8(0x150)](this[_0x5e79f8(0x171)][_0x5e79f8(0x17a)](_0x55fc1a),0x1));}get[_0x3d8b17(0x16f)](){const _0x1fbc8e=_0x3d8b17;return this[_0x1fbc8e(0x171)][this[_0x1fbc8e(0x171)][_0x1fbc8e(0x1b3)]-0x1];}[_0x3d8b17(0x158)](_0x17f94d){const _0x2c37f8=_0x3d8b17;this[_0x2c37f8(0x1b4)][_0x2c37f8(0x158)](_0x17f94d);}async[_0x3d8b17(0x1b7)]({content:_0x36b959,version:_0x58b395,sessionId:_0x584c71,selections:_0x4681fe}){const _0x9ee41a=_0x3d8b17;await this[_0x9ee41a(0x1b4)][_0x9ee41a(0x159)](_0x36b959,_0x58b395,_0x584c71,_0x4681fe);}[_0x3d8b17(0x147)](){const _0xc1b83b=_0x3d8b17;return this[_0xc1b83b(0x19d)]?.[_0xc1b83b(0x167)]()?.[_0xc1b83b(0x18e)]||'';}[_0x3d8b17(0x17f)](_0x14b905){const _0x2ec0eb=_0x3d8b17;this[_0x2ec0eb(0x1b4)][_0x2ec0eb(0x17f)](_0x14b905);}[_0x3d8b17(0x1a3)](){const _0x43b5f9=_0x3d8b17;this[_0x43b5f9(0x1b4)][_0x43b5f9(0x1a3)]();}[_0x3d8b17(0x176)](_0x3422ef){const _0x425e63=_0x3d8b17;this[_0x425e63(0x1b4)][_0x425e63(0x176)](_0x3422ef);}[_0x3d8b17(0x17c)](_0x37ec73){const _0x17d899=_0x3d8b17;this[_0x17d899(0x1b4)][_0x17d899(0x17c)](_0x37ec73);}[_0x3d8b17(0x185)](_0x15be05,_0x383728){const _0x18e68a=_0x3d8b17;this[_0x18e68a(0x1b4)][_0x18e68a(0x185)](_0x15be05,_0x383728);}[_0x3d8b17(0x19e)](_0x2c27c6,_0x4afe9c,_0x3fee95){const _0xa7980a=_0x3d8b17;return this[_0xa7980a(0x1b4)][_0xa7980a(0x19e)](_0x2c27c6,_0x4afe9c,_0x3fee95);}[_0x3d8b17(0x14e)](_0x216de7){const _0x5ee816=_0x3d8b17;this[_0x5ee816(0x1b4)][_0x5ee816(0x14e)](_0x216de7);}[_0x3d8b17(0x19b)](){const _0x5be922=_0x3d8b17;this[_0x5be922(0x16a)][_0x5be922(0x19b)]();}[_0x3d8b17(0x1a9)](){const _0x562973=_0x3d8b17;this[_0x562973(0x16a)][_0x562973(0x1a9)]();}[_0x3d8b17(0x15a)](){const _0xc27dc0=_0x3d8b17;return this[_0xc27dc0(0x1b4)][_0xc27dc0(0x15a)]();}[_0x3d8b17(0x1b6)](){const _0x2c99ba=_0x3d8b17;return this[_0x2c99ba(0x1b4)][_0x2c99ba(0x1b6)]();}[_0x3d8b17(0x1b0)](){const _0x51e7d3=_0x3d8b17;return this[_0x51e7d3(0x1b4)][_0x51e7d3(0x1b0)]();}async[_0x3d8b17(0x148)](_0x10f5be){const _0xd154db=_0x3d8b17;_0x10f5be?!0x1===await this[_0xd154db(0x14a)][_0xd154db(0x16e)](_0x10f5be)&&(_0x4c944b(_0xd154db(0x184),{'conversation':this,'model':_0x10f5be}),_0x10f5be=(await this[_0xd154db(0x14a)][_0xd154db(0x180)]())[0x0]):(_0x4c944b(_0xd154db(0x181),{'conversation':this}),_0x10f5be=(await this[_0xd154db(0x14a)][_0xd154db(0x180)]())[0x0]),_0x10f5be['id']!==this[_0xd154db(0x170)]?.['id']&&(this[_0xd154db(0x170)]=_0x10f5be,this[_0xd154db(0x16a)][_0xd154db(0x162)](),this[_0xd154db(0x178)](_0xd154db(0x18b),{'selectedModel':_0x10f5be}));}}