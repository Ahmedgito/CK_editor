/*
 *             Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x412485=_0x36ad;(function(_0x179403,_0xba19be){const _0x334823=_0x36ad,_0x25c759=_0x179403();while(!![]){try{const _0x12713f=parseInt(_0x334823(0x16e))/0x1+-parseInt(_0x334823(0x1b5))/0x2*(parseInt(_0x334823(0x17f))/0x3)+-parseInt(_0x334823(0x167))/0x4+-parseInt(_0x334823(0x1a8))/0x5+parseInt(_0x334823(0x194))/0x6+-parseInt(_0x334823(0x18b))/0x7+-parseInt(_0x334823(0x188))/0x8*(-parseInt(_0x334823(0x191))/0x9);if(_0x12713f===_0xba19be)break;else _0x25c759['push'](_0x25c759['shift']());}catch(_0x42500e){_0x25c759['push'](_0x25c759['shift']());}}}(_0x4589,0xe231a));import{Plugin as _0x3887a4}from'ckeditor5/src/core.js';function _0x4589(){const _0x259874=['connection','cloud-services-internal-error:\x20Not\x20connected.','keys','reverse','wrongRequestId','requires','connected','addRevisionData','map','isEmptyCurrent','_startingVersion','config','data','getMany','isBundleUploaded','getRevisions','bind','remove','RevisionHistory','_fetchMissingUsers','cloud-services-internal-error:\x20Revision\x20History\x20Service\x20is\x20not\x20connected.','collaboration.channelId','updateRevisions','_bufferUpdate','getOperations','RevisionTracker','setRevisionData','startsWith','get','code','state','CONNECTED','adapter','catch','5839452SfoqFc','buildRevisionData','_revisionDataBuilder','revisionsUpdated','destroy','add','_revisionTracker','400469Aqjpsp','editor','diffData','cloudServices.bundleVersion','addToReconnectionStack','isEnabled','baseVersion','reInit','_waitForServiceReady','_lastRequestId','reconnect','plugins','isConnected','400','creatorId','pluginName','_handleRevisionsUpdate','2270604dGjavA','then','fromVersion','once','getRevision','sendBufferedUpdates','currentRevision','has','_isConnected','136JzswgG','type','authors','10417400KAHbsb','_fixRevision','change:_isPendingUpdate','setSource','marker','_update','2146617xnJloE','from','createdAt','10291332KfoumC','serverHistory','_isPendingUpdate','CloudServicesRevisionHistoryAdapter','_handleReconnectionError','isOfficialPlugin','repository','_getLatestVersionFromServerOperations','affectsData','size','addUser','off','cloud-services-internal-error:\x20Request\x20timeout.','getUser','_getLatestVersion','authorsIds','sessionId','_oldOffset','_offset','length','3910615WUCwIu','message','_revisionHistoryService','connect','_createCurrentRevision','_bufferedUpdates','_revisions','isPremiumPlugin','max','init','toVersion','_preventResendingRevisionData','listenTo','4mEiinD','change:_isConnected','RevisionHistoryService'];_0x4589=function(){return _0x259874;};return _0x4589();}import{version as _0x753e11}from'ckeditor5/src/utils.js';import{Users as _0x94c81b}from'ckeditor5-collaboration/src/collaboration-core.js';import{RealTimeCollaborationClient as _0x323deb}from'../realtimecollaborativeediting/realtimecollaborationclient.js';import{WebSocketGateway as _0x306636}from'../realtimecollaborativeediting/websocketgateway.js';function _0x36ad(_0x2ca817,_0x3a0936){const _0x4589d2=_0x4589();return _0x36ad=function(_0x36ad3f,_0x1b6162){_0x36ad3f=_0x36ad3f-0x158;let _0x5a69d0=_0x4589d2[_0x36ad3f];return _0x5a69d0;},_0x36ad(_0x2ca817,_0x3a0936);}import{Sessions as _0x2ba5e5}from'../realtimecollaborativeediting/sessions.js';import{EditorService as _0x173588,RevisionHistoryService as _0x36f512,User as _0x1fa1d5,WEB_SOCKET_GATEWAY_STATES as _0x586d21}from'@ckeditor/ckeditor-cloud-services-collaboration/src/services.js';export class CloudServicesRevisionHistoryAdapter extends _0x3887a4{static [_0x412485(0x1b7)]=/* #__PURE__ -- @preserve */
((()=>_0x36f512)());[_0x412485(0x177)];[_0x412485(0x16d)];[_0x412485(0x1aa)];[_0x412485(0x1a5)];static get[_0x412485(0x1bd)](){const _0x38e555=_0x412485;return[_0x306636,_0x323deb,_0x38e555(0x1ca),_0x2ba5e5,_0x94c81b];}static get[_0x412485(0x17d)](){const _0xc0d3c3=_0x412485;return _0xc0d3c3(0x197);}static get[_0x412485(0x199)](){return!0x0;}static get[_0x412485(0x1af)](){return!0x0;}constructor(_0x42546f){const _0x46f373=_0x412485;super(_0x42546f);const _0x26aaa0=this[_0x46f373(0x16f)][_0x46f373(0x1c3)][_0x46f373(0x161)](_0x46f373(0x15a));this[_0x46f373(0x177)]=null,this[_0x46f373(0x16d)]=this[_0x46f373(0x16f)][_0x46f373(0x179)][_0x46f373(0x161)](_0x46f373(0x15e)),this[_0x46f373(0x1aa)]=new CloudServicesRevisionHistoryAdapter[(_0x46f373(0x1b7))](_0x26aaa0);}async[_0x412485(0x1b1)](){const _0x1b86c5=_0x412485,_0x3527b9=this[_0x1b86c5(0x16f)][_0x1b86c5(0x179)][_0x1b86c5(0x161)](_0x323deb),_0x34d3c9=_0x3527b9[_0x1b86c5(0x195)],_0x7bd56f=this[_0x1b86c5(0x16f)][_0x1b86c5(0x179)][_0x1b86c5(0x161)](_0x306636);this[_0x1b86c5(0x16d)][_0x1b86c5(0x18e)]({'history':_0x34d3c9,'getLatestVersion':()=>this[_0x1b86c5(0x1a2)](),'getCurrentRevisionId':()=>_0x3527b9[_0x1b86c5(0x1a4)]});const _0x2e8420=this[_0x1b86c5(0x16f)][_0x1b86c5(0x1c3)][_0x1b86c5(0x161)](_0x1b86c5(0x171))||_0x753e11,_0x3f0c5e=await _0x173588[_0x1b86c5(0x1c6)](_0x7bd56f[_0x1b86c5(0x1b8)],_0x2e8420);this[_0x1b86c5(0x16f)][_0x1b86c5(0x179)][_0x1b86c5(0x161)](_0x1b86c5(0x1ca))[_0x1b86c5(0x165)]={'getRevision':async({revisionId:_0x53fd4a})=>(await this[_0x1b86c5(0x176)](),await this[_0x1b86c5(0x1aa)][_0x1b86c5(0x183)](_0x53fd4a)),'updateRevisions':async _0x4b3b63=>{const _0x479a2f=_0x1b86c5;await this[_0x479a2f(0x176)]();const _0x3ca5=this[_0x479a2f(0x16d)][_0x479a2f(0x185)];if(_0x3f0c5e&&0x1===_0x4b3b63[_0x479a2f(0x1a7)]&&_0x4b3b63[0x0]['id']===_0x3ca5['id'])return _0x4b3b63;for(const _0x3f6938 of _0x4b3b63)_0x3f6938['id']===_0x3ca5['id']&&(_0x3f6938[_0x479a2f(0x1c1)]=_0x3f6938[_0x479a2f(0x181)]===_0x3f6938[_0x479a2f(0x1b2)]);return this[_0x479a2f(0x1aa)][_0x479a2f(0x15b)](_0x4b3b63,this[_0x479a2f(0x177)])[_0x479a2f(0x180)](_0x4f18ee=>(this[_0x479a2f(0x177)]=_0x4f18ee,_0x4b3b63))[_0x479a2f(0x166)](_0x2089ec=>{const _0x36dea4=_0x479a2f;if(M(_0x2089ec)||_0x36dea4(0x17b)===_0x2089ec[_0x36dea4(0x162)]&&void 0x0!==_0x2089ec[_0x36dea4(0x1c4)][_0x36dea4(0x1bc)]){for(const _0x10aee9 of _0x4b3b63){!this[_0x36dea4(0x16d)][_0x36dea4(0x19a)][_0x36dea4(0x183)](_0x10aee9['id'])||this[_0x36dea4(0x16d)][_0x36dea4(0x15c)](_0x10aee9['id'],_0x10aee9,!0x1);}if(M(_0x2089ec))throw _0x2089ec;return _0x4b3b63;}throw _0x2089ec;});}},this[_0x1b86c5(0x1b4)](this[_0x1b86c5(0x1aa)],_0x1b86c5(0x16a),(_0x38b013,{revisionsData:_0x34ca6d,requestId:_0x1c0f2d})=>{const _0x35ff42=_0x1b86c5;Math[_0x35ff42(0x1b0)](..._0x34ca6d[_0x35ff42(0x1c0)](_0x378aa3=>_0x378aa3[_0x35ff42(0x1b2)]))>this[_0x35ff42(0x19b)]()-0x1?this[_0x35ff42(0x1a2)]()[_0x35ff42(0x180)](()=>{const _0x29a185=_0x35ff42;this[_0x29a185(0x17e)](_0x34ca6d,_0x1c0f2d);}):this[_0x35ff42(0x17e)](_0x34ca6d,_0x1c0f2d);});const {revisions:_0x147b6e,requestId:_0x853f15}=await this[_0x1b86c5(0x1aa)][_0x1b86c5(0x1ab)](_0x7bd56f[_0x1b86c5(0x1b8)]);_0x7bd56f[_0x1b86c5(0x172)](this),this[_0x1b86c5(0x177)]=_0x853f15,await this[_0x1b86c5(0x158)](_0x147b6e);for(const _0x41a480 of _0x147b6e)this[_0x1b86c5(0x16d)][_0x1b86c5(0x1bf)](_0x41a480);this[_0x1b86c5(0x1b4)](_0x3527b9,_0x1b86c5(0x1b6),(_0x181946,_0x10c01c,_0xeeb2ff)=>{const _0x5b65c1=_0x1b86c5;_0xeeb2ff&&(this[_0x5b65c1(0x1a5)]=_0x3527b9[_0x5b65c1(0x1a6)],_0x181946[_0x5b65c1(0x19f)]());}),this[_0x1b86c5(0x16d)][_0x1b86c5(0x1c8)](_0x1b86c5(0x173))['to'](_0x7bd56f,_0x1b86c5(0x163),_0x405432=>_0x405432===_0x586d21[_0x1b86c5(0x164)]);}async[_0x412485(0x178)](){const _0xd49984=_0x412485,_0x264735=this[_0xd49984(0x16f)][_0xd49984(0x179)][_0xd49984(0x161)](_0x306636),_0x30737d=this[_0xd49984(0x16f)][_0xd49984(0x179)][_0xd49984(0x161)](_0x323deb),_0x1e0743=async()=>{const _0x3db516=_0xd49984,_0x834e33=this[_0x3db516(0x16d)][_0x3db516(0x185)],_0x1a8bb6=_0x834e33['id'],_0x27889c=_0x1a8bb6!==_0x30737d[_0x3db516(0x1a4)];if(_0x27889c){const _0x27f0f0=_0x30737d[_0x3db516(0x1a6)]-this[_0x3db516(0x1a5)],_0x2305aa=this[_0x3db516(0x19b)]();this[_0x3db516(0x16d)][_0x3db516(0x169)][_0x3db516(0x175)]();if(_0x834e33[_0x3db516(0x1b2)]+_0x27f0f0!==_0x2305aa){const _0x46aa28=_0x834e33[_0x3db516(0x181)]+_0x27f0f0,_0x52f686=this[_0x3db516(0x16f)][_0x3db516(0x179)][_0x3db516(0x161)](_0x94c81b),_0x29c2ad=this[_0x3db516(0x16d)][_0x3db516(0x168)]({'revision':_0x834e33,'from':_0x46aa28,'to':_0x2305aa});_0x29c2ad['id']=_0x834e33['id'];const _0x400746=_0x29c2ad[_0x3db516(0x1a3)][_0x3db516(0x1c0)](_0x55131d=>_0x52f686[_0x3db516(0x1a1)](_0x55131d));_0x834e33[_0x3db516(0x190)]({..._0x29c2ad,'authors':_0x400746},!0x0),this[_0x3db516(0x16d)][_0x3db516(0x15c)](_0x834e33['id'],_0x29c2ad,!0x0);}this[_0x3db516(0x16d)][_0x3db516(0x1c2)]=_0x2305aa,(_0x834e33[_0x3db516(0x1b2)]===_0x834e33[_0x3db516(0x181)]&&!this[_0x3db516(0x16d)][_0x3db516(0x1ad)][_0x3db516(0x186)](_0x1a8bb6)&&this[_0x3db516(0x16d)][_0x3db516(0x19a)][_0x3db516(0x1ae)][_0x3db516(0x1c9)](_0x1a8bb6),this[_0x3db516(0x16d)][_0x3db516(0x1ac)](_0x2305aa));}const {revisions:_0x1de97d,requestId:_0x39393e}=await this[_0x3db516(0x1aa)][_0x3db516(0x178)](_0x264735[_0x3db516(0x1b8)],this[_0x3db516(0x177)]);_0x27889c&&_0x1de97d[_0x3db516(0x1a7)]>0x0?_0x30737d[_0x3db516(0x198)]():(await this[_0x3db516(0x158)](_0x1de97d),this[_0x3db516(0x17e)](_0x1de97d,_0x39393e),this[_0x3db516(0x16d)][_0x3db516(0x184)]());};return _0x30737d[_0xd49984(0x187)]?_0x1e0743():new Promise((_0x2e6af5,_0x595252)=>{const _0x4b23c0=_0xd49984;_0x30737d[_0x4b23c0(0x182)](_0x4b23c0(0x1b6),()=>{const _0x39d2f6=_0x4b23c0;_0x1e0743()[_0x39d2f6(0x180)](_0x2e6af5)[_0x39d2f6(0x166)](_0x595252);});});}[_0x412485(0x16b)](){const _0x3bc4f2=_0x412485;super[_0x3bc4f2(0x16b)]();}async[_0x412485(0x176)](){const _0x2d7eee=_0x412485;this[_0x2d7eee(0x1aa)][_0x2d7eee(0x17a)]||await new Promise(_0x363343=>{const _0xbc5965=_0x2d7eee;this[_0xbc5965(0x1b4)](this[_0xbc5965(0x1aa)],_0xbc5965(0x1be),_0x568f8f=>{const _0x2b41fc=_0xbc5965;_0x568f8f[_0x2b41fc(0x19f)](),_0x363343();});});}[_0x412485(0x19b)](){const _0x31a4d6=_0x412485,_0x2d98c7=this[_0x31a4d6(0x16f)][_0x31a4d6(0x179)][_0x31a4d6(0x161)](_0x323deb)[_0x31a4d6(0x195)][_0x31a4d6(0x15d)]()[_0x31a4d6(0x1bb)]();for(const _0x32c549 of _0x2d98c7)if(_0x31a4d6(0x18f)!==_0x32c549[_0x31a4d6(0x189)]||_0x32c549[_0x31a4d6(0x19c)])return _0x32c549[_0x31a4d6(0x174)]+0x1;}[_0x412485(0x1a2)](){const _0x5072f6=_0x412485,_0x2c7335=this[_0x5072f6(0x16f)][_0x5072f6(0x179)][_0x5072f6(0x161)](_0x323deb);return new Promise(_0xd13caa=>{const _0x5daa7b=_0x5072f6;_0x2c7335[_0x5daa7b(0x196)]?_0x2c7335[_0x5daa7b(0x182)](_0x5daa7b(0x18d),()=>{const _0x105b93=_0x5daa7b;_0xd13caa(this[_0x105b93(0x19b)]());}):_0xd13caa(this[_0x5daa7b(0x19b)]());});}[_0x412485(0x17e)](_0x2c3650,_0x282642){const _0x16d640=_0x412485,_0x2c17a9=this[_0x16d640(0x16d)][_0x16d640(0x19a)];this[_0x16d640(0x177)]=_0x282642;for(const _0x110026 of _0x2c3650){const _0x95b27b=_0x2c17a9[_0x16d640(0x183)](_0x110026['id']);if(_0x95b27b){if((_0x110026[_0x16d640(0x181)]||_0x110026[_0x16d640(0x1b2)])&&(_0x110026[_0x16d640(0x170)]=null),_0x95b27b===this[_0x16d640(0x16d)][_0x16d640(0x185)]){const _0x5ad2ca=Math[_0x16d640(0x1b0)](_0x95b27b[_0x16d640(0x1b2)],_0x110026[_0x16d640(0x1b2)]),_0x485a0d=Math[_0x16d640(0x1b0)](_0x95b27b[_0x16d640(0x181)],_0x110026[_0x16d640(0x181)]);let _0x48868b;_0x95b27b[_0x16d640(0x1b2)]===_0x110026[_0x16d640(0x1b2)]&&_0x95b27b[_0x16d640(0x181)]===_0x110026[_0x16d640(0x181)]?(_0x48868b=!0x0,this[_0x16d640(0x1b3)](_0x110026)):_0x110026[_0x16d640(0x1b2)]===_0x5ad2ca&&_0x110026[_0x16d640(0x181)]===_0x485a0d?_0x48868b=!0x1:(_0x95b27b[_0x16d640(0x1b2)]===_0x5ad2ca&&_0x95b27b[_0x16d640(0x181)]===_0x485a0d||this[_0x16d640(0x18c)]({'revision':_0x95b27b,'from':_0x485a0d,'to':_0x5ad2ca}),_0x48868b=!0x0),_0x48868b&&(delete _0x110026[_0x16d640(0x181)],delete _0x110026[_0x16d640(0x1b2)],delete _0x110026[_0x16d640(0x170)],delete _0x110026[_0x16d640(0x193)],delete _0x110026[_0x16d640(0x1a3)]);}this[_0x16d640(0x16d)][_0x16d640(0x15f)](_0x110026),this[_0x16d640(0x1b3)](_0x110026);}else this[_0x16d640(0x16d)][_0x16d640(0x1bf)](_0x110026);}const _0x147261=_0x2c17a9[_0x16d640(0x1c7)]();_0x147261[_0x16d640(0x1bb)]();for(let _0x1b3c34=0x0;_0x1b3c34<_0x147261[_0x16d640(0x1a7)]-0x1;_0x1b3c34++){const _0xa1ba8c=_0x147261[_0x1b3c34],_0x5cf2b9=_0x147261[_0x1b3c34+0x1];if(_0xa1ba8c[_0x16d640(0x181)]<_0x5cf2b9[_0x16d640(0x1b2)]){const _0x329ae2=_0x5cf2b9[_0x16d640(0x1b2)],_0xb71c2c=Math[_0x16d640(0x1b0)](_0x329ae2,_0xa1ba8c[_0x16d640(0x1b2)]);this[_0x16d640(0x18c)]({'revision':_0xa1ba8c,'from':_0x329ae2,'to':_0xb71c2c});}}}[_0x412485(0x18c)]({revision:_0x229365,from:_0x328bea,to:_0x331b7d}={}){const _0x3fdc8d=_0x412485,_0x503f65=this[_0x3fdc8d(0x16f)][_0x3fdc8d(0x179)][_0x3fdc8d(0x161)](_0x94c81b),_0x50b27e=this[_0x3fdc8d(0x16d)][_0x3fdc8d(0x168)]({'revision':_0x229365,'from':_0x328bea,'to':_0x331b7d});_0x50b27e[_0x3fdc8d(0x18a)]=_0x50b27e[_0x3fdc8d(0x1a3)][_0x3fdc8d(0x1c0)](_0x400dc9=>_0x503f65[_0x3fdc8d(0x1a1)](_0x400dc9)),_0x229365[_0x3fdc8d(0x190)](_0x50b27e);}[_0x412485(0x1b3)](_0x4f1dbf){const _0x281d15=_0x412485,_0x57c797={};_0x57c797['id']=_0x4f1dbf['id'];for(const _0x5b1ec1 of Object[_0x281d15(0x1ba)](_0x4f1dbf))'id'!==_0x5b1ec1&&(_0x57c797[_0x5b1ec1]=void 0x0);this[_0x281d15(0x16d)][_0x281d15(0x15c)](_0x57c797['id'],_0x57c797,!0x0);}async[_0x412485(0x158)](_0x3f3ac2){const _0x27b7d9=_0x412485,_0x1a7438=this[_0x27b7d9(0x16f)][_0x27b7d9(0x179)][_0x27b7d9(0x161)](_0x94c81b),{connection:_0x443c5c}=this[_0x27b7d9(0x16f)][_0x27b7d9(0x179)][_0x27b7d9(0x161)](_0x306636),_0x1d432b=new Set();for(const _0x94ce5b of _0x3f3ac2){for(const _0x574f79 of _0x94ce5b[_0x27b7d9(0x1a3)])_0x22154f(_0x574f79);_0x94ce5b[_0x27b7d9(0x17c)]&&_0x22154f(_0x94ce5b[_0x27b7d9(0x17c)]);}if(0x0===_0x1d432b[_0x27b7d9(0x19d)])return;const _0xfed04e=await _0x1fa1d5[_0x27b7d9(0x1c5)](_0x443c5c,Array[_0x27b7d9(0x192)](_0x1d432b));for(const _0x48d203 of _0xfed04e)_0x1a7438[_0x27b7d9(0x1a1)](_0x48d203['id'])||_0x1a7438[_0x27b7d9(0x19e)](_0x48d203);function _0x22154f(_0x3416a2){const _0x8b2a06=_0x27b7d9;_0x1a7438[_0x8b2a06(0x1a1)](_0x3416a2)||_0x1d432b[_0x8b2a06(0x16c)](_0x3416a2);}}}function M(_0x2f2970){const _0x128e65=_0x412485;return _0x2f2970[_0x128e65(0x1a9)][_0x128e65(0x160)](_0x128e65(0x159))||_0x2f2970[_0x128e65(0x1a9)][_0x128e65(0x160)](_0x128e65(0x1b9))||_0x2f2970[_0x128e65(0x1a9)][_0x128e65(0x160)](_0x128e65(0x1a0));}